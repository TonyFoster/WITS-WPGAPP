<div class="p-4">
  <h1 class="text-2xl font-bold text-center mb-4">Attendance Converter</h1>

  <div class="flex flex-col items-center space-y-8 p-4">
    <!-- Step 1: Upload Excels -->
    <div class="w-full max-w-md">
      <label class="block text-sm font-medium text-gray-700">
        Step 1: 上傳大聯大成員的工時表
      </label>
      <input type="file" multiple accept=".xlsx,.xls"
             (change)="onFileChange($event)"
             [disabled]="excelUploaded"
             class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100" />
      <div *ngIf="filesData.length" class="mt-4">
        <p class="font-bold">Uploaded Employees:</p>
        <ul class="list-disc pl-5">
          <li *ngFor="let file of filesData">{{ file.name }}</li>
        </ul>
      </div>
    </div>

    <!-- Step 2: Upload Input Data -->
    <div class="w-full max-w-md">
      <label class="block text-sm font-medium text-gray-700">
        Step 2: 上傳大聯大給的差勤資料
      </label>
      <input type="file" accept=".xlsx,.xls"
             (change)="onDataFileChange($event)"
             [disabled]="dataUploaded"
             class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100" />
      <div *ngIf="dataRows.length" class="mt-4">
        <p class="font-bold">Uploaded Data: {{ dataRows.length }} rows</p>
      </div>
    </div>

    <!-- Step 3: Enter File Prefix -->
    <div class="w-full max-w-md">
      <label class="block text-sm font-medium text-gray-700">
        Step 3: 輸入檔案前輟 (可省略)
      </label>
      <input type="text"
             [(ngModel)]="filePrefix"
             placeholder="Enter prefix for downloaded files"
             class="mt-1 block w-full p-2 border rounded-lg text-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
    </div>

    <!-- Step 4: Download Excels -->
    <button (click)="downloadExcels()"
            [disabled]="!(dataUploaded && excelUploaded)"
            class="mt-4 px-6 py-3 font-semibold rounded-lg shadow-md transition-all
                   text-white bg-blue-600 hover:bg-blue-700
                   disabled:bg-gray-300 disabled:cursor-not-allowed">
      下載工時表
    </button>

  </div>
</div>
